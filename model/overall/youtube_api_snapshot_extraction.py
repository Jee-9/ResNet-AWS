# -*- coding: utf-8 -*-
"""YouTube API Snapshot extraction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1X4Ffxv8pzZZzTiihD9oH7BBjGCm2jGLP
"""

import numpy as np
import pandas as pd

import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings(action = 'ignore')

import cv2

from google.colab import drive
drive.mount('/content/drive')

# cap = cv2.VideoCapture('/content/drive/MyDrive/Youtube_API/Mukbang/SUB)á„€á…ªá„Œá…³á†¸á„‘á…¡á†¼á„‘á…¡á†¼ á„€á…ªá„‹á…µá†¯ á„†á…¥á†¨á„‡á…¡á†¼ !ğŸ’ğŸ“ğŸ‹ á„†á…¦á„…á…©á†« á„†á…¡á†¼á„€á…© á„‘á…¡á„‹á…µá†«á„‹á…¢á„‘á…³á†¯ á„‹á…­á†¼á„€á…ª á„ƒá…¢á„‹á…ªá†¼á„„á…¡á†¯á„€á…µ á„€á…²á†¯ (featá„‹á…­á„€á…¥á„á…³á„Šá…µá„…á…µá„‹á…¥á†¯) fruit mukbang ASMR melon mango strawberry.mp4')

# while(cap.isOpened()):
#   ret, frame = cap.read()
#   gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
#   cv2.imshow('frame', gray)

#   if cv2.waitKey(1) & 0xFF == ord('q'):
#     break

# cap.release()
# cv2.destroyAllWindows()

import glob # ì‚¬ìš©ìê°€ ì œì‹œí•œ ì¡°ê±´ì— ë§ëŠ” íŒŒì¼ëª…ì„ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ì œì‹œ

mb_list = glob.glob('/content/drive/MyDrive/Youtube_API/Mukbang/*.webm')
gm_list = glob.glob('/content/drive/MyDrive/Youtube_API/Game/*.webm')

# import os
# os.listdir('/content/drive/MyDrive/Youtube_API/Mukbang/')

mb_list[16]

len(gm_list)

for index, vid in enumerate(mb_list):
  try:
    cap = cv2.VideoCapture(mb_list[index])

    sample_num = 0
    captured_num = 0

    if not cap.isOpened():
      print("Cannot open the cap")
    else:
      pass

    while(cap.isOpened()):
      ret, frame = cap.read()
      sample_num += 1

      if not ret:
        print(ret)
        break

      if sample_num == 60:
        captured_num += 1
        cv2.imwrite('/content/drive/MyDrive/Youtube_API/Mukbang_img/'+ str(index) + '_' +str(captured_num) + '.jpg', frame) # ìœ¼ì‰?
        sample_num = 0

    cap.release()


  except Exception as e:
    print(e)

# vid_title = '[á„‹á…©á„‡á…¥á„‹á…¯á„á…µ] á„á…©á†¨ á„€á…µá„‹á…¥á†¨á„’á…¢á„‹á…£ á„’á…¡á†¯ á„†á…¦á„…á…³á„‰á…µ á„‰á…®á„’á…©á„á…¥á†«á„‰á…¡ á„á…®á†¯á„á…µá†¸ 5á„€á…¡á„Œá…µ á„ƒá…¡á†« 3á„‡á…®á†« á„†á…¦á„…á…³á„‰á…µ á„Œá…¡á†¼á„‹á…µá†«á„‹á…µ á„ƒá…¬á„‚á…³á†« á„‡á…¡á†¼á„‡á…¥á†¸'
# # cap = cv2.VideoCapture('/content/drive/MyDrive/Youtube_API/Mukbang/' + vid_title + '.mp4')


cap = cv2.VideoCapture('/content/drive/MyDrive/Youtube_API/Mukbang/SUB)á„†á…¢á„‹á…®á†« á„’á…¢á„†á…®á†¯á„á…µá†· á„†á…¥á†¨á„‡á…¡á†¼ğŸ”¥ á„‚á…¡á†¨á„Œá…µ á„†á…®á†«á„‹á…¥ á„Œá…¥á†«á„‡á…©á†¨ á„€á…¡á†¸á„‹á…©á„Œá…µá†¼á„‹á…¥ á„‰á…¢á„‹á…®á„‹á…¦ á„ƒá…¡á†¼á„†á…§á†«á„á…¡á„Œá…µ á„…á…µá„‹á…¥á†¯á„‰á…¡á„‹á…®á†«á„ƒá…³  Spicy Seafood Mukbang Asmr.webm')

sample_num = 0
captured_num = 0

# if not cap.isOpened():
#   print("Cannot open the cap")
# else:
#   raise Exception("capture is not opened")

# while(cap.isOpened()):
for i in range(99999999999999):

  if not cap.isOpened():
    # print("Capture object is not opened")
    raise Exception("capture is not opened")
    break

  ret, frame = cap.read()
  print(f"success: {ret}, frame shape: {frame.shape}")
  sample_num += 1

  if not ret:
    print(ret)
    break

  if sample_num == 60:
    captured_num += 1
    # cv2.imwrite('/content/drive/MyDrive/Youtube_API/Game_img/'+vid_title+str(captured_num) + '.jpg', frame)///
    cv2.imwrite('/content/drive/MyDrive/Youtube_API/test/'+str(captured_num) + '.jpg', frame)
    sample_num = 0


cap.release()

# # video ì €ì¥ 

# cap = cv2.VideoCapture(0)

# fourcc = cv2.VideoWriter_fourcc(*'DIVX')
# out = cv2.VideoWriter('test.avi', fourcc, 25.0, (640, 400))

# while (cap.isOpened()):
#   ret, frame = cap.read()

#   if ret:
#     frame = cv2.flip(frame, 0)

#     out.write(frame)

#     cv2.imshow('frame', frame)

#     if cv2.waitKey(0) & 0xFF == ord('q'):
#       break

# cap.release()
# out.release()
# cv2.destroyAllWindows()

gm_list

"""### Game ì˜ìƒ forë¬¸ ë‹¤ìš´ë°›ëŠ” ì½”ë“œ"""

for index, vid in enumerate(gm_list):
  try:
    cap = cv2.VideoCapture(gm_list[index])

    sample_num = 0
    captured_num = 0

    if not cap.isOpened():
      print("Cannot open the cap")
    else:
      pass

    while(cap.isOpened()):
      ret, frame = cap.read()
      sample_num += 1

      if not ret:
        print(ret)
        break

      if sample_num == 60:
        captured_num += 1
        cv2.imwrite('/content/drive/MyDrive/Youtube_API/Game_imgs/'+ str(index) + '_' +str(captured_num) + '.jpg', frame) # ìœ¼ì‰?
        sample_num = 0

    cap.release()


  except Exception as e:
    print(e)

